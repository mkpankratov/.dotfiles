#!/usr/bin/env bash
set -euo pipefail

WS="2:telegram"
APP_ID="telegram-desktop_telegram-desktop"
CMD="telegram-desktop"

# 1) Switch to workspace
swaymsg -q "workspace 2:telegram"

# Change waybar bg
printf 'window#waybar { background: transparent}' > $HOME/.config/waybar/wsbg.css

# 2) Check if a container with this app_id exists
if swaymsg -t get_tree | jq -e --arg app "$APP_ID" '.. | objects | select(.app_id? == $app)' >/dev/null; then
  # Optional: focus it if it exists
  swaymsg -q "[app_id=\"$APP_ID\"] focus"
else
  # 3) Launch if not running
  swaymsg -q -- "exec --no-startup-id $CMD"
fi
